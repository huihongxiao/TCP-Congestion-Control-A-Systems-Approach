# 2.2 可靠的字节流（Reliable Byte-Stream）

在IP协议的尽力而为（best-effort）传输模型之上，在运行于终端主机上的一对进程之间，TCP实现了可靠的字节流。这一节会详细描述TCP的实现，以助于更好的理解后面章节将要介绍的拥塞控制算法。

## 2.2.1 端到端的问题

TCP的核心是滑动窗口算法。除了熟悉的确认/超时/重传机制外，还必须解决下面的问题。

1. 首先，因为TCP运行在互联网上的任意两个计算机上的两个进程之间，它需要一个明确的连接建立过程，使得传输的双方都同意与对方传输数据。在连接建立的过程中，TCP的传输双方需要共享状态以启动滑动窗口算法。传输结束后还需要关闭连接，这样每个终端才知道可以释放状态。
2. 其次，不同的TCP 连接有可能有极其不同的 RTT（Round-trip time，往返时间）时间。例如，San Francisco 和 Boston之间相隔数千公里，它们之间的TCP 连接RTT 可能需要 100ms。然而，同一个房间的两个主机之间的 TCP 连接可能只需要 1ms 的 RTT。同一个 TCP 协议需要能同时支持这两种场景。更糟糕的是，Francisco 和 Boston之间的 TCP 连接可能在早上 3 点的时候 RTT 时 100ms，到了下午 3 点 RTT 就变成了 500ms。甚至在一个仅持续几分钟的 TCP 连接中，RTT也可能发生改变。这意味着，在滑动窗口算法中，触发重传的超时机制必须是自适应的。
3. 第三，由于互联网的尽力而为传输特性，packet 在传输过程中可能会乱序。packet 轻微的乱序不会造成问题，因为滑动窗口算法可以基于 sequence number 正确的重拍 packets。
